<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>면허판매희망가 등록 및 알림 신청</title>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/webfontworld/nanumsquare/NanumSquareEB.css">

    <style>
        /* ======================================= */
        /* === 공통 스타일 (Step 1 & 2) === */
        /* ======================================= */
        body {
            /* **⭐⭐ 모든 글꼴을 'NanumSquareEB'로 통일 ⭐⭐** */
            font-family: 'NanumSquareEB', sans-serif;
            background-color: #f0f4f9;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 40px 20px;
            margin: 0;
        }
        .main-container {
            width: 100%;
            max-width: 500px;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .header h1 {
            color: #1f3d79;
            font-size: 26px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .header p {
            color: #cc0000;
            font-size: 16px;
            margin: 0;
        }
        .card {
            background-color: #ffffff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
            margin-bottom: 20px;
        }
        .step-title {
            color: #1f3d79;
            font-size: 24px;
            font-weight: bold;
            padding-bottom: 15px;
            border-bottom: 1px dashed #e0e0e0;
            margin-bottom: 35px;
        }
        .form-group {
            margin-bottom: 30px;
        }
        .label-text {
            font-size: 20px;
            color: #333;
            font-weight: bold;
            margin-bottom: 15px;
            display: block;
        }
        
        .input-box-style {
            height: 48px;
            padding: 10px 8px; 
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            box-sizing: border-box;
            background-color: #fffde7;
            font-size: 18px;
            transition: all 0.2s ease-in-out;
            text-align: center;
            /* 기본 드롭다운/화살표 제거 */
            -webkit-appearance: none; 
            -moz-appearance: none;
            appearance: none;
            /* 기본 화살표 배경 이미지 제거 */
            background-image: none;
        }
        .input-box-style:focus {
            border-color: #007bff;
            background-color: #e6f7ff;
            box-shadow: 0 0 0 4px rgba(0, 123, 255, 0.25);
            outline: none;
        }

        /* 차량번호 선택 필드에만 드롭다운 화살표 표시 */
        #car-hangul {
            /* 커스텀 드롭다운 화살표 다시 적용 */
            background-image: url('data:image/svg+xml;utf8,<svg fill="%23333333" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18px" height="18px"><path d="M7 10l5 5 5-5z"/></svg>');
            background-repeat: no-repeat;
            background-position: right 8px center;
        }
        
        /* JS 돋보기 효과를 위한 폰트 사이즈 확대 클래스 */
        .zoom-text {
            font-size: 24px !important;
            font-weight: 900 !important;
        }

        /* 숫자 입력 필드 스피너 제거 (Webkit) */
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { 
            -webkit-appearance: none;
            margin: 0;
        }
        /* 숫자 입력 필드 스피너 제거 (Firefox) */
        input[type=number] {
            -moz-appearance: textfield;
        }

        input[type="text"], input[type="number"], input[type="tel"], select {
            width: 100%;
        }
        
        /* 버튼 스타일 */
        .btn-group {
            display: flex;
            gap: 10px;
            width: 100%;
        }
        .submit-btn, .back-btn {
            padding: 18px;
            font-size: 20px;
            font-weight: bold;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .submit-btn {
            background-color: #4a77d4;
            color: white;
            flex-grow: 4;
        }
        .back-btn {
            background-color: #cccccc;
            color: #333;
            flex-grow: 1;
        }

        /* ======================================= */
        /* === 단계 1 스타일 (희망가) === */
        /* ======================================= */
        #step2 {
            display: none;
        }
        /* 안내 문구와 입력란 사이 간격 조절 */
        .price-instruction {
            color: #cc0000; 
            font-size: 16px; 
            margin-bottom: 30px;
            text-align: center;
            font-weight: bold;
            display: block;
        }

        .price-input-group {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 10px;
        }
        .price-input-group span {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            white-space: nowrap;
        }
        .price-input-group input {
            flex-grow: 1;
            margin: 0 15px;
            text-align: center;
            font-weight: bold;
        }

        /* ======================================= */
        /* === 단계 2 스타일 (연락처/차량) === */
        /* ======================================= */
        .phone-input-group {
            display: flex;
            align-items: stretch;
            height: 48px;
        }
        .phone-input-group .prefix {
            background-color: #4a77d4;
            color: white;
            padding: 10px 15px;
            border-radius: 6px 0 0 6px;
            border: 1px solid #4a77d4;
            font-weight: bold;
            white-space: nowrap;
            display: flex;
            align-items: center;
            font-size: 18px;
        }
        .phone-input-group input {
            border-left: none;
            border-radius: 0 6px 6px 0;
            text-align: center;
        }
        
        .car-input-group {
            display: flex;
            gap: 5px;
            align-items: stretch;
            flex-wrap: nowrap;
            height: 48px;
        }
        .car-input-group > * {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        .car-area-text {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            white-space: nowrap;
            padding: 0 5px;
        }
        /* 차량번호 입력란 너비 최종 조정 (양 끝 정렬) */
        .car-input-group input[placeholder="2자"] {
            flex-basis: 22%;
        }
        .car-input-group select {
            flex-basis: 25%;
        }
        .car-input-group input[placeholder="4자"] {
            flex-basis: 40%;
        }
        
        /* 개인정보 동의 영역 */
        .consent-area {
            display: flex;
            align-items: flex-start;
            margin-top: 40px;
            margin-bottom: 25px;
        }
        .consent-area input[type="checkbox"] {
            width: 24px;
            height: 24px;
            margin-top: 3px;
            margin-right: 20px; 
        }
        .consent-label {
            font-size: 18px;
            font-weight: bold;
            line-height: 1.5;
            white-space: nowrap;
        }
        
        /* 개인정보 상세 박스 스타일 */
        .detail-box {
            border: 1px solid #ccc;
            padding: 15px;
            height: 140px;
            overflow-y: scroll;
            font-size: 14px;
            line-height: 1.5;
            color: #666;
            background-color: #fafafa;
            border-radius: 6px;
        }
        .detail-box ul {
            padding-left: 18px;
            margin: 5px 0 10px 0;
            list-style-type: decimal;
        }
        .detail-box p {
            font-weight: bold;
            color: #333;
            margin-top: 10px;
            font-size: 15px;
        }
        .company-info {
            font-size: 14px;
            text-align: right;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="main-container">
        <div class="header">
            <h1>면허판매희망가 등록 및 알림 신청</h1>
            <p>면허시세가 희망가 도달 전에 알려드립니다.</p>
        </div>

        <div id="step1">
            <div class="card">
                <div class="step-title">1단계 : 판매희망가 입력</div>
                <form id="formStep1">
                    <div class="form-group">
                        <span class="price-instruction">※ 면허가격만 적어주세요.</span>
                        
                        <div class="price-input-group">
                            <span>1억</span>
                            <input type="number" id="price_input" class="input-box-style focus-zoom" placeholder="숫자입력" required
                                onfocus="handleFocus(this)" onblur="handleBlur(this)">
                            <span class="unit-text">만원</span>
                        </div>
                    </div>
                </form>
            </div>
            <div class="btn-group">
                <button class="submit-btn" onclick="nextStep()" style="flex-grow: 1;">다음 단계로</button>
            </div>
        </div>

        <div id="step2">
            <form id="formStep2" 
                action="https://docs.google.com/forms/u/0/d/e/1FAIpQLSdpKzOTZqQX4JEf_RsWKh1OfBy1CnjhmOGJb2MY3MdmX_Xluw/formResponse" 
                method="POST"
                onsubmit="return validateAndSubmit(event)"
                target="hidden_iframe"
            >
                <div class="card">
                    <div class="step-title">2단계 : 연락정보 입력</div>
                    
                    <input type="hidden" id="hidden_price" name="entry.1421085577">
                    
                    <div class="form-group">
                        <label class="label-text" for="name">성함</label>
                        <input type="text" id="name" name="entry.839758910" class="input-box-style focus-zoom" placeholder="성함 입력" required
                            onfocus="handleFocus(this)" onblur="handleBlur(this)">
                    </div>

                    <div class="form-group">
                        <label class="label-text" for="phone">전화번호</label>
                        <div class="phone-input-group">
                            <div class="prefix">010 -</div>
                            <input type="tel" id="phone" name="phone_raw" class="input-box-style focus-zoom" style="border-left:none;" placeholder="8자리 입력" 
                                maxlength="9" 
                                pattern="\d{4}-?\d{4}" 
                                required
                                oninput="formatPhoneNumber(this)"
                                onfocus="handleFocus(this)" onblur="handleBlur(this)">
                            <input type="hidden" id="phone_full" name="entry.514804681">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="label-text">차량번호 (예시: 서울12아1234)</label>
                        <div class="car-input-group">
                            <span class="car-area-text">서울</span>
                            
                            <input type="number" id="car-num-2" class="input-box-style focus-zoom" placeholder="2자" maxlength="2"
                                oninput="limitInputLength(this, 2)"
                                onfocus="handleFocus(this)" onblur="handleBlur(this)">
                            
                            <select id="car-hangul" class="input-box-style focus-zoom"
                                onfocus="handleFocus(this)" onblur="handleBlur(this)">
                                <option value="">선택</option>
                                <option>아</option>
                                <option>바</option>
                                <option>사</option>
                                <option>자</option>
                            </select>
                            
                            <input type="number" id="car-num-4" class="input-box-style focus-zoom" placeholder="4자" maxlength="4"
                                oninput="limitInputLength(this, 4)"
                                onfocus="handleFocus(this)" onblur="handleBlur(this)">
                            
                            <input type="hidden" id="car-number-full" name="entry.311694843" required>
                        </div>
                    </div>

                    <div class="consent-area">
                        <input type="checkbox" id="consent" name="entry.364932315" value="예" required>
                        <label for="consent" class="consent-label">개인정보 수집 및 이용 동의</label>
                    </div>
                    
                    <div class="detail-box">
                        <p>[개인정보 수집 및 이용 동의 상세]</p>
                        <ul>
                            <li>수집 항목: 면허판매희망가, 성함, 전화번호, 차량번호</li>
                            <li>수집 목적: 택시면허 판매희망가 도달 알림 및 상담 진행</li>
                            <li>보유 및 이용 기간: 동의일로부터 3년 (알림 및 상담 종료 후 지체 없이 파기)</li>
                            <li>동의 거부 시 불이익: 상기 개인정보 수집 및 이용에 동의하지 않을 경우, 희망가 등록 및 알림 신청 서비스가 제한될 수 있습니다.</li>
                        </ul>
                        <p>※ 추가 내용: 본 서비스의 최종 거래 가격은 시장 상황 및 개별 협상에 따라 달라질 수 있습니다.</p>
                        <div class="company-info">주식회사 한국모빌리티연구소 귀중</div>
                    </div>
                </div>
                
                <div class="btn-group">
                    <button type="button" class="back-btn" onclick="prevStep()">뒤로</button>
                    <button type="submit" class="submit-btn">신청하기</button>
                </div>
            </form>
            
            <iframe name="hidden_iframe" id="hidden_iframe" style="display:none;" onload="if(submitted) {redirectToThankYou();}"></iframe>
        </div>
    </div>

    <script>
        let priceValue = ""; 
        let submitted = false; // 제출 상태 플래그

        // 돋보기 효과 (포커스 시 텍스트 확대 및 시각적 강조)
        function handleFocus(element) {
            element.classList.add('zoom-text');
        }
        function handleBlur(element) {
            element.classList.remove('zoom-text');
        }

        // 차량번호 입력 길이 제한 함수 (type="number" 오류 해결)
        function limitInputLength(element, limit) {
            if (element.value.length > limit) {
                element.value = element.value.slice(0, limit);
            }
        }

        // 전화번호 입력 시 자동 하이픈 포맷팅 및 8자리 입력 유지
        function formatPhoneNumber(input) {
            let value = input.value.replace(/[^0-9]/g, ''); // 숫자만 남기고 제거
            
            // 8자리만 유지
            if (value.length > 8) {
                 value = value.substring(0, 8);
            }
            
            // 하이픈 추가 (4자리 이상일 때)
            if (value.length > 4) {
                input.value = value.substring(0, 4) + '-' + value.substring(4);
            } else {
                input.value = value;
            }
        }

        // 1단계 -> 2단계 이동 함수
        function nextStep() {
            const priceInput = document.getElementById('price_input');
            
            if (!priceInput.checkValidity() || priceInput.value.length === 0) {
                priceInput.reportValidity();
                return;
            }
            
            priceValue = `1억 ${priceInput.value}만원`;
            document.getElementById('hidden_price').value = priceValue;
            
            document.getElementById('step1').style.display = 'none';
            document.getElementById('step2').style.display = 'block';
            window.scrollTo(0, 0); 
        }

        // 2단계 -> 1단계 되돌아가기 함수
        function prevStep() {
            document.getElementById('step2').style.display = 'none';
            document.getElementById('step1').style.display = 'block';
            window.scrollTo(0, 0); 
        }
        
        // 제출 후 땡큐 페이지로 리디렉션
        function redirectToThankYou() {
            // 제출 플래그 초기화
            submitted = false; 
            // 실제 thank you 페이지 경로로 변경 필요
            window.location.href = "thankyou.html";
        }


        // 2단계 유효성 검사 및 최종 제출 함수
        function validateAndSubmit(event) {
            const form = document.getElementById('formStep2');
            
            // 1. HTML5 기본 유효성 검사
            if (!form.checkValidity()) {
                form.reportValidity();
                event.preventDefault();
                return false;
            }

            // 2. 전화번호 최종 통합 및 8자리 확인
            const phoneInput = document.getElementById('phone');
            const phoneRaw = phoneInput.value.replace(/[^0-9]/g, ''); // 하이픈 제거 후 숫자만 추출
            
            if (phoneRaw.length !== 8) {
                 alert('전화번호 8자리를 정확히 입력해주세요.');
                 event.preventDefault();
                 return false;
            }
            
            // 전송을 위해 010-8자리 통합
            const fullPhoneNumber = `010-${phoneRaw.substring(0, 4)}-${phoneRaw.substring(4)}`;
            document.getElementById('phone_full').value = fullPhoneNumber; 
            
            // 3. 차량번호 통합 및 추가 유효성 검사
            const num2 = document.getElementById('car-num-2').value;
            const hangul = document.getElementById('car-hangul').value;
            const num4 = document.getElementById('car-num-4').value;
            
            if (num2.length !== 2 || hangul === '' || num4.length !== 4) {
                alert('차량번호 (2자리-한글-4자리)를 모두 정확히 입력해주세요.');
                event.preventDefault();
                return false;
            }

            const fullCarNumber = `서울${num2}${hangul}${num4}`;
            document.getElementById('car-number-full').value = fullCarNumber;
            
            // 4. 모든 검증 통과 시
            submitted = true; // 제출 플래그 설정
            
            // 폼 제출 진행 (Google Forms로 데이터 전송)
            
            return true;
        }
    </script>
</body>
</html>
